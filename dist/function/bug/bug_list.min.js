(()=>{async function t(){let t=await new Promise(((t,e)=>chrome.storage.local.get("settings",(function(e){t(e)})))),e=null;return t&&t.hasOwnProperty("settings")&&(e=t.settings),e}async function e(){let t=await new Promise(((t,e)=>chrome.storage.local.get("bug_data",(function(e){t(e)})))),e=null;return t&&t.hasOwnProperty("bug_data")&&(e=t.bug_data),e}async function s(){let t=await new Promise(((t,e)=>chrome.storage.local.get("import_status",(function(e){t(e)})))),e=null;return t&&t.hasOwnProperty("import_status")&&(e=t.import_status),e}document.getElementById("start_import").addEventListener("click",(async function(){const a=await t();if(!a)return chrome.tabs.create({active:!0,url:"settings.html"},null),void chrome.runtime.sendMessage("",{req:"notif",options:{title:"Settings",message:"Please import settings!",iconUrl:"/img/ex_logo.png",type:"basic"}},(function(t){console.log(t)}));let n=await e();n.dataList&&0!==n.dataList.length&&n.dataList.filter((t=>t.temp_checked_status.rsl_status.includes("IGNORE"))).length!==n.dataList.length?"done"!==(await s()).status?confirm("Are you sure?")&&(chrome.storage.local.set({import_status:{status:"ready",is_first_time:!0}},(function(){console.log("Value is set to ","ready")})),window.location.href=a.common.jira_base_url+"/login.jsp"):alert("Data has imported"):alert("No record import/update")})),document.getElementById("close_tab").addEventListener("click",(async function(){chrome.runtime.sendMessage({req:"close_this_tab"},(function(t){console.log(t)}))})),document.addEventListener("DOMContentLoaded",(async function(){const a={description:"Description",assigner:"Assign",cause_analysis:"Cause Analysis",cause_category:"Cause Category",corrective_action:"Corrective Action",defect_origin:"Defect Origin",defect_type:"Defect Type",due_date:"Due Date",estimated_effort:"Estimated Effort",original_estimate:"Original Estimate",plan_start_date:"Plan Start",priority:"Priority",qc_activity:"QC Activity",remaining_estimate:"Remaining Estimate",reporter:"Reporter",role:"Role",severity:"Severity",summary:"Summary"},n=await t();if(!n)return;let i=await s();var r;function o(t,e){const s=n.bug.temp_col_index,a=Object.fromEntries(Object.entries(s).sort((([,t],[,e])=>t-e)));let i="";for(let s=0;s<t.length;s++){if(e&&"UPDATE"===e){if(!t[s].temp_checked_status.rsl_status.includes("UPDATE_BASE_DATA")&&(!t[s].temp_checked_status.rsl_status.includes("CHANGE_STATUS")||t[s].temp_checked_status.rsl_status.includes("NEW")||t[s].temp_checked_status.rsl_status.includes("ERROR")))continue}else if(e&&!t[s].temp_checked_status.rsl_status.includes(e))continue;let n="";for(const e in a)null===a[e]||e.startsWith("temp")||e.startsWith("__")||(n+=`<td class="error" data-bs-toggle="tooltip" data-bs-html="true" title="${t[s].temp_checked_status.rsl_msg.join("<br>")}"><pre class="content_fix">${null!=t[s][e]?c(t[s][e]):"(Empty)"}</pre></td>`);let o=(r=t[s]).temp_checked_status.rsl_status.includes("ERROR")?"red":r.temp_checked_status.rsl_status.includes("NEW")?"green":r.temp_checked_status.rsl_status.includes("CHANGE_STATUS")||r.temp_checked_status.rsl_status.includes("UPDATE_BASE_DATA")?"blue":r.temp_checked_status.rsl_status.includes("OK")?"#D0FA58":void 0;i+="red"===o?`<tr class="issue" style="border-bottom: solid 1px ${o}; background: #faf3f3">${n}</tr>`:`<tr class="issue" style="border-bottom: solid 1px ${o}">${n}</tr>`}var r;document.getElementById("data_content_id").innerHTML=i;let o=document.getElementsByClassName("error");for(let t=0;t<o.length;t++)new bootstrap.Tooltip(o[t],{boundary:document.body})}i&&i.hasOwnProperty("result")&&"done"===i.status&&(r=i.result,navigator.clipboard.writeText(r).then((function(){alert("Copy success\n"+r)}),(function(t){console.error("Async: Could not copy text: ",t)}))),document.querySelector("link[rel~='icon']").href=chrome.runtime.getURL("img/ex_logo.ico"),async function(){(function(){const t=n.bug.temp_col_index,e=Object.fromEntries(Object.entries(t).sort((([,t],[,e])=>t-e)));let s="";for(const t in e)null===e[t]||t.startsWith("temp")||t.startsWith("__")||(s+=`<th scope="col">${a[t]}</th>`);document.getElementById("header_column_id").innerHTML=s})(),o((await e()).dataList)}();const c=t=>t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");var l=document.querySelectorAll('input[type=radio][name="options_filter"]');async function u(t){"NEW"===this.value&&o((await e()).dataList,"NEW"),"ERROR"===this.value&&o((await e()).dataList,"ERROR"),"UPDATE"===this.value&&o((await e()).dataList,"UPDATE"),"ALL"===this.value&&o((await e()).dataList)}Array.prototype.forEach.call(l,(function(t){t.addEventListener("change",u)}))}))})();